<mxfile host="65bd71144e">
    <diagram name="CORAL Architecture" id="coral-arch">
        <mxGraphModel dx="909" dy="615" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="800" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="input" value="Input Features&#xa;(768 dimensions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="50" y="200" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="linear" value="Linear Layer&#xa;768 → 256" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="250" y="200" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="relu" value="ReLU&#xa;Activation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="450" y="200" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="dropout" value="Dropout&#xa;(rate=0.2)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="650" y="200" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="coral_layer" value="CORAL Layer&#xa;256 → (num_classes-1)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="850" y="200" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="true_labels" value="True Labels&#xa;(Class indices)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="650" y="350" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="levels_conv" value="Levels Conversion&#xa;levels_from_labelbatch" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="850" y="350" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="coral_loss" value="CORAL Loss&#xa;coral_loss(logits, levels)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="1050" y="275" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="sigmoid" value="Sigmoid&#xa;Activation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="850" y="100" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="prediction" value="Prediction&#xa;proba_to_label" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f0f0f0;strokeColor=#666666;fontStyle=1;fontSize=14;" parent="1" vertex="1">
                    <mxGeometry x="1050" y="100" width="140" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="input" target="linear" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="linear" target="relu" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="relu" target="dropout" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="dropout" target="coral_layer" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="coral_layer" target="sigmoid" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="sigmoid" target="prediction" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="coral_layer" target="coral_loss" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="true_labels" target="levels_conv" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="arrow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="levels_conv" target="coral_loss" edge="1">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="title" value="CORAL Classifier Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=18;" parent="1" vertex="1">
                    <mxGeometry x="500" y="30" width="300" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="legend" value="Legend:&#xa;• Input/Output: Light Blue&#xa;• Neural Layers: Purple&#xa;• Activations: Green&#xa;• Regularization: Yellow&#xa;• CORAL Components: Orange/Red&#xa;• Final Output: Gray" style="text;html=1;strokeColor=#666666;fillColor=#f0f0f0;align=left;verticalAlign=top;whiteSpace=wrap;rounded=1;fontSize=12;" parent="1" vertex="1">
                    <mxGeometry x="50" y="450" width="200" height="120" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>